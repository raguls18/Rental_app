<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find Your Perfect Rental - RentHouse</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/property-details-modal.css">
    <style>
        /* CSS from your original file (omitted for brevity, assume it is linked or placed here) */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; color: #333; }
        .main-header { background: rgba(255, 255, 255, 0.98); box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1); position: sticky; top: 0; z-index: 1000; backdrop-filter: blur(10px); }
        .container { max-width: 1400px; margin: 0 auto; padding: 0 20px; }
        .header-content { display: flex; justify-content: space-between; align-items: center; padding: 20px 0; }
        .logo { font-size: 32px; font-weight: 700; color: #667eea; display: flex; align-items: center; gap: 12px; }
        .main-nav { display: flex; gap: 30px; align-items: center; }
        .main-nav a { text-decoration: none; color: #333; font-weight: 500; font-size: 16px; transition: all 0.3s ease; display: flex; align-items: center; gap: 8px; padding: 8px 16px; border-radius: 8px; }
        .main-nav a:hover { color: #667eea; background: rgba(102, 126, 234, 0.1); }
        .btn-logout { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white !important; padding: 10px 20px !important; border-radius: 25px; }
        .btn-logout:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4); }
        main { padding: 40px 20px; }
        .search-filters { background: white; border-radius: 20px; padding: 40px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1); margin-bottom: 40px; }
        .search-filters h2 { font-size: 32px; margin-bottom: 30px; color: #333; display: flex; align-items: center; gap: 12px; }
        .search-filters h2::before { content: 'üîç'; font-size: 36px; }
        .filters-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 25px; margin-bottom: 30px; }
        .filter-item { display: flex; flex-direction: column; gap: 10px; }
        .filter-item label { font-weight: 600; color: #555; font-size: 15px; display: flex; align-items: center; gap: 8px; }
        .filter-item label i { color: #667eea; }
        .filter-item input, .filter-item select { padding: 14px 18px; border: 2px solid #e0e0e0; border-radius: 12px; font-size: 15px; transition: all 0.3s ease; background: white; }
        .filter-item input:focus, .filter-item select:focus { outline: none; border-color: #667eea; box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1); }
        .filter-actions { display: flex; gap: 15px; flex-wrap: wrap; }
        .btn-primary, .btn-secondary { padding: 14px 32px; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 10px; }
        .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4); }
        .btn-secondary { background: #f5f5f5; color: #666; }
        .btn-secondary:hover { background: #e0e0e0; }
        #properties-section h2 { color: white; font-size: 36px; margin-bottom: 30px; text-align: center; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2); }
        .loading-text { text-align: center; color: white; font-size: 20px; padding: 60px 20px; }
        .loading-text i { font-size: 36px; margin-bottom: 15px; display: block; }
        #no-results { background: white; border-radius: 20px; padding: 60px 40px; text-align: center; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1); }
        #no-results h3 { font-size: 28px; margin-bottom: 15px; color: #333; }
        #no-results p { font-size: 18px; color: #666; }
        .properties-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 30px; }
        .property-card { background: white; border-radius: 20px; overflow: hidden; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); transition: all 0.3s ease; cursor: pointer; position: relative; }
        .property-card:hover { transform: translateY(-8px); box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2); }
        .property-image {
    width: 100%;
    height: 250px; /* Needs a fixed height */
    background-size: cover; /* Important for scaling */
    background-position: center; /* Important for positioning */
    position: relative;
}
        .property-price { position: absolute; top: 15px; left: 15px; background: rgba(255, 255, 255, 0.95); padding: 10px 20px; border-radius: 25px; font-weight: 700; color: #667eea; font-size: 20px; }
        .favorite-btn { position: absolute; top: 15px; right: 15px; background: rgba(255, 255, 255, 0.95); border: none; width: 45px; height: 45px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease; }
        .favorite-btn:hover { transform: scale(1.1); background: white; }
        .favorite-btn i { color: #ff6b6b; font-size: 22px; transition: all 0.3s ease; }
        .favorite-btn.active i { font-weight: 900; }
        .property-details { padding: 25px; }
        .property-title { font-size: 22px; font-weight: 700; margin-bottom: 10px; color: #333; }
        .property-location { color: #666; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; font-size: 15px; }
        .property-features { display: flex; gap: 20px; margin-bottom: 15px; padding-top: 15px; border-top: 2px solid #f0f0f0; }
        .feature { display: flex; align-items: center; gap: 6px; color: #666; font-size: 15px; }
        .feature i { color: #667eea; }
        .view-details-btn { width: 100%; padding: 12px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; text-decoration: none; display: block; text-align: center; }
        .view-details-btn:hover { opacity: 0.9; transform: translateY(-2px); }
        @media (max-width: 768px) {
            .header-content { flex-direction: column; gap: 20px; }
            .main-nav { flex-wrap: wrap; justify-content: center; }
            .filters-grid { grid-template-columns: 1fr; }
            .properties-grid { grid-template-columns: 1fr; }
            .search-filters { padding: 25px; }
            .logo { font-size: 24px; }
        }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="container">
            <div class="header-content">
                <h1 class="logo"><i class="fas fa-home"></i> RentHouse</h1>
                <nav class="main-nav">
                    <a href="favoritesseeker.html"><i class="fas fa-heart"></i> Favorites</a>
                    <a href="seeker-profile.html"><i class="fas fa-user-circle"></i> Profile</a>
                    <a href="#" id="nav-logout-btn" class="btn-logout"><i class="fas fa-sign-out-alt"></i> Logout</a>
                    <a href="login.html" id="nav-login-link" style="display: none;"><i class="fas fa-sign-in-alt"></i> Login</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="container">
        <section class="search-filters">
            <h2>Find Your Dream Home</h2>
            <div class="filters-grid">
                <div class="filter-item">
                    <label for="location-search"><i class="fas fa-map-marker-alt"></i> Location</label>
                    <input type="text" id="location-search" placeholder="City, Area, Pincode...">
                </div>
                <div class="filter-item">
                    <label for="type-filter"><i class="fas fa-building"></i> Property Type</label>
                    <select id="type-filter">
                        <option value="">All Types</option>
                        <option value="Apartment">Apartment</option>
                        <option value="House">House</option>
                        <option value="Villa">Villa</option>
                        <option value="Studio">Studio</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label for="bedrooms-filter"><i class="fas fa-bed"></i> Bedrooms</label>
                    <select id="bedrooms-filter">
                        <option value="">Any</option>
                        <option value="1">1+ BHK</option>
                        <option value="2">2+ BHK</option>
                        <option value="3">3+ BHK</option>
                        <option value="4">4+ BHK</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label for="rent-filter"><i class="fas fa-rupee-sign"></i> Rent Range</label>
                    <select id="rent-filter">
                        <option value="">Any</option>
                        <option value="0-10000">Up to ‚Çπ10,000</option>
                        <option value="10000-20000">‚Çπ10,000 - ‚Çπ20,000</option>
                        <option value="20000-35000">‚Çπ20,000 - ‚Çπ35,000</option>
                        <option value="35000-50000">‚Çπ35,000 - ‚Çπ50,000</option>
                        <option value="50000-max">Above ‚Çπ50,000</option>
                    </select>
                </div>
            </div>
            
            <div class="filter-actions">
                <button id="apply-filters-btn" class="btn-primary"><i class="fas fa-search"></i> Search Properties</button>
                <button id="clear-filters-btn" class="btn-secondary"><i class="fas fa-redo"></i> Clear Filters</button>
                <button id="save-search-btn" class="btn-secondary"><i class="fas fa-bookmark"></i> Save Search</button>
            </div>
        </section>

        <section id="properties-section">
            <h2>‚ú® Available Properties</h2>
            
            <div id="loading-indicator" class="loading-text">
                <i class="fas fa-spinner fa-spin"></i>
                Loading amazing properties for you...
            </div>
            
            <div id="no-results" style="display: none;">
                <h3>No Properties Found üòû</h3>
                <p>Try resetting the filters or broadening your search criteria.</p>
            </div>

            <div id="properties-grid" class="properties-grid">
            </div>
        </section>
    </main>

  
    <script>
        // --- Favorites Logic (Inline) ---
        // Make this global so external scripts (like search.js) can access it
        window.favorites = JSON.parse(localStorage.getItem('favorites') || '[]');

        function toggleFavorite(propertyId, button) {
            // Re-read favorites from global variable/localStorage
            let favorites = window.favorites;
            const index = favorites.indexOf(propertyId);
            
            if (index > -1) {
                // Case 1: Property IS in favorites -> REMOVE IT
                favorites.splice(index, 1);
                button.querySelector('i').classList.remove('fas');
                button.querySelector('i').classList.add('far');
                button.classList.remove('active');
                
                showNotification('Removed from favorites', 'error');
            } else {
                // Case 2: Property is NOT in favorites -> ADD IT
                favorites.push(propertyId);
                button.querySelector('i').classList.remove('far');
                button.querySelector('i').classList.add('fas');
                button.classList.add('active');
                
                // Show success animation
                button.style.transform = 'scale(1.3)';
                setTimeout(() => {
                    button.style.transform = 'scale(1)';
                }, 200);
                
                showNotification('Added to favorites!', 'success');
            }
            
            localStorage.setItem('favorites', JSON.stringify(favorites));
            window.favorites = favorites; // Update the global variable
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed; top: 100px; right: 20px; 
                background: ${type === 'success' ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' : '#ff6b6b'};
                color: white; padding: 15px 25px; border-radius: 12px; 
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2); z-index: 10000; 
                font-weight: 600; display: flex; align-items: center; gap: 10px;
                animation: slideIn 0.3s ease;
            `;
            notification.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : 'times-circle'}"></i> ${message}`;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 2000);
        }

        /**
         * @function initializeFavorites
         * This function manually attaches click listeners and sets the correct heart icon state
         * for dynamically loaded property cards. Called by search.js.
         */
        window.initializeFavorites = function() {
            window.favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            
            document.querySelectorAll('.property-card').forEach(card => {
                const propertyId = card.dataset.propertyId;
                const btn = card.querySelector('.favorite-btn');
                if (!btn || !propertyId) return;

                // 1. Set initial icon state based on local storage
                if (window.favorites.includes(propertyId)) {
                    btn.querySelector('i').className = 'fas fa-heart';
                    btn.classList.add('active');
                } else {
                    btn.querySelector('i').className = 'far fa-heart';
                    btn.classList.remove('active');
                }
                
                // 2. Attach click event listener
                btn.onclick = function(e) {
                    e.stopPropagation(); // Stop propagation to prevent card view link from firing
                    toggleFavorite(propertyId, this);
                };
            });
        }

        // --- CSS Animation (Keep this) ---
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn { from { transform: translateX(400px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
            @keyframes slideOut { from { transform: translateX(0); opacity: 1; } to { transform: translateX(400px); opacity: 0; } }
        `;
        document.head.appendChild(style);
    </script>
    
    <script type="module" src="js/firebase-auth.js"></script>
    <script type="module" src="js/search.js"></script>
    <script type="module" src="js/seeker-enhanced.js"></script>
</body>
</html>
